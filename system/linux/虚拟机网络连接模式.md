# 虚拟机网络连接模式



## 1.、桥接模式

- **工作原理**：虚拟机网卡直接“桥接”到物理网卡，就像把一根网线插到交换机上一样。
- **IP 地址**：虚拟机会从 **局域网 DHCP 服务器**（比如路由器）获取一个和宿主机同网段的 IP。
- **访问特性**：
  - 虚拟机在局域网里表现为一台独立电脑。
  - 局域网里的其他电脑可以直接访问虚拟机（比如 SSH、数据库）。
- **使用场景**：
  - 需要让虚拟机对外提供服务（如 Web、数据库）。
  - 多台电脑之间要互相访问虚拟机。

📌 **例子**：
 宿主机 IP：`192.168.1.10`
 虚拟机 IP：`192.168.1.20`
 同一个局域网的电脑 `192.168.1.30` 就可以直接访问 `192.168.1.20:3306`。



## 2、NAT 模式

- **工作原理**：虚拟机通过宿主机做网络地址转换，借用宿主机的网络上网。
- **IP 地址**：虚拟机通常会拿到一个 **虚拟子网的 IP**（如 `10.0.2.15`），外部电脑看不到这个地址。
- **访问特性**：
  - 虚拟机可以访问外网（通过宿主机转发）。
  - 外部电脑 **默认无法访问虚拟机**。
  - 如果需要外部访问，就必须配置 **端口转发**：
    - 宿主机 `192.168.1.10:8080` → 转发到虚拟机 `10.0.2.15:8080`
- **使用场景**：
  - 只需要虚拟机上网，不需要别人访问虚拟机。
  - 比如学习 Linux、安装软件、上网更新系统。

📌 **例子**：
 宿主机 IP：`192.168.1.10`
 虚拟机 IP（NAT 内部）：`10.0.2.15`
 同网段的电脑 `192.168.1.30` 想访问虚拟机 → 默认不行，除非你做 NAT 端口映射。



## 3、主机模式

- **工作原理**
  - 虚拟机软件（比如 VirtualBox/VMware）会在宿主机上创建一个虚拟网卡（Host-Only Adapter）。
  - 虚拟机连到这个虚拟网卡所在的网络。
  - 这个网络和真实的物理网卡、外部网络是隔离的。
- **IP 地址**
  - 宿主机和虚拟机会分配在 **同一个虚拟网段**，例如：
    - 宿主机虚拟网卡 IP：`192.168.56.1`
    - 虚拟机 IP：`192.168.56.101`
  - 这个网段 **不会出现在局域网里**，只存在于宿主机和虚拟机之间。

- **访问特性**
  - **宿主机 ↔ 虚拟机**：可以互相访问（比如宿主机能 SSH 到虚拟机）。
  - **虚拟机 ↔ 虚拟机**（同样是 Host-Only 的虚拟机）：可以互相访问。
  - **虚拟机 ↔ 外网**：默认不能访问，需要再加一块 NAT 网卡或桥接网卡。
  - **局域网其他电脑 ↔ 虚拟机**：不能访问（因为这个虚拟网络是宿主机私有的）。
- **使用场景**
  - 想要 **在宿主机和虚拟机之间做实验**，但不想让虚拟机暴露在局域网。
  - 多台虚拟机之间需要互通（比如做一个测试集群），但不需要外部机器访问。
  - 配合 NAT 使用：一块 NAT 网卡让虚拟机上外网，一块 Host-Only 网卡保证宿主机 ↔ 虚拟机通信。

📌 **例子**：

- 宿主机 IP（真实网卡）：`192.168.1.10`（局域网）
- 宿主机虚拟网卡 IP（Host-Only）：`192.168.56.1`
- 虚拟机 IP（Host-Only）：`192.168.56.101`

结果：

- 宿主机能 `ping 192.168.56.101`，能访问虚拟机。
- 局域网其他电脑（比如 `192.168.1.20`）**访问不到**虚拟机。
- 虚拟机也上不了网，除非再加一块 NAT 网卡。



## 4、模式对比

| 特性                     | 桥接模式                               | NAT 模式                         |
| ------------------------ | -------------------------------------- | -------------------------------- |
| **IP 地址**              | 虚拟机与宿主机在同一网段（路由器分配） | 虚拟机在独立子网（虚拟网卡分配） |
| **虚拟机上网**           | 直接通过局域网网关                     | 通过宿主机做 NAT 转换            |
| **局域网能否访问虚拟机** | ✅ 可以，直接用虚拟机 IP                | ❌ 默认不行，需要做端口转发       |
| **安全性**               | 暴露在局域网中，安全性稍低             | 隐藏在宿主机后，更安全           |
| **使用场景**             | 提供服务（Web/DB/SSH）                 | 学习/测试/只需要上网             |



| 模式          | 虚拟机 IP 来源             | 能否上网 | 局域网能否访问虚拟机       | 使用场景                 |
| ------------- | -------------------------- | -------- | -------------------------- | ------------------------ |
| **桥接**      | 局域网 DHCP/手动分配       | ✅ 可以   | ✅ 可以                     | 提供服务，像一台独立电脑 |
| **NAT**       | 虚拟子网（VM 内部分配）    | ✅ 可以   | ❌ 不行（除非端口转发）     | 默认使用，学习、上网     |
| **Host-Only** | 虚拟子网（Host-Only 网卡） | ❌ 不行   | ❌ 不行（只有宿主机能访问） | 实验、宿主机与 VM 通信   |



👉 一句话总结：

- **桥接模式**：虚拟机就是局域网里的“独立电脑”。
- **NAT 模式**：虚拟机藏在宿主机后面，可以上网，但别人访问不到。
- **主机模式 (Host-Only)**：虚拟机只能和宿主机通信，局域网和外网都不行。